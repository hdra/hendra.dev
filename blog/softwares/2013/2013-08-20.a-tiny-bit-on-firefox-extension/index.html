<!doctype html><html><head><link href="https://fonts.googleapis.com/css?family=Gentium+Book+Basic|Merriweather:400,300" rel=stylesheet type=text/css><link rel=stylesheet href=/styles/style.min.adafe591d9bc2917608cd56205e2997041b7f1d2a684555879647388e2c838f2.css></head><body><div class=container><header class=blog-header><h1><a href=https://hendra.dev/>hendra.dev</a></h1><p>A work in progress</p><nav><ul class=nav><li><a href=/blog/>blogs</a></li><li><a href=/notes/>notes</a></li></ul></nav></header><div class=post><header><h1>A Tiny Bit on Firefox Extension</h1><p class=date>Written on <time datetime=2013-08-20T14:33:00+0700>Aug 20, 2013</time></p></header><article><p>I stumbled on <a href=http://coryg89.github.io/technical/2013/08/13/how-to-create-your-own-chrome-extensions/>this</a> article on creating Chrome extension, and really, it seems really simple to do build an extension for the browser. So, I thought what would it take to build the same thing for Firefox?</p><p>It turns out, it is pretty simple as well, but when you are just getting started, find out where to get started aren&rsquo;t really straightforward. The getting started documents aren&rsquo;t exactly well organized. To start with, there are two different ways to build an add-on for Firefox. The XUL tool set, and also, the new Add-on SDK. The <a href=https://addons.mozilla.org/developers/>add-ons developer page</a> highlights the Add-on SDK, but the links below mostly deal with the XUL tools. The difference between the two can be found on <a href=https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/guides/sdk-vs-xul.html>this page</a>. Basically, the Add-on SDK is the one that is simpler, the documentation can be found <a href=https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/index.html>here</a>.</p><p>Anyway, once you found the documentation, everything should be pretty easy to follow. Mozilla provides <a href=https://builder.addons.mozilla.org/>Add-on Builder</a>, a web-app that allows you to build add-ons for Firefox, but I prefer to download the SDK to my computer and use my preferred text editor. The SDK is basically a python environment setup with everything you need to build an add-on, so you would need to have python installed on your computer. Whichever method you chose, the method are basically the same.</p><h2 id=building-the-add-on>Building the Add-on</h2><p>So, moving on to building actual add-on. Like the example in the post linked above, it is a simple add-ons that adds a context menu that allows you to search MDN for the selected text. To be honest, I am not sure what to write in this post, because it is much more simpler than I thought.</p><p>Like the Chrome extension, a Firefox add-on is built with HTML/CSS and Javascript. There is a <code>package.json</code> that contains the meta-data of the add-on that is a generated for you anyway. Your code will mainly goes to the <code>main.js</code> file in the <code>lib</code> folder of your add-on directory. You can put your extra data, such as to the CSS files, extra javascript libraries, images, etc in the <code>data</code> folder. All these folders are generated automatically with the initialization of the add-on, along with a <code>doc</code> and <code>test</code> folder, which pretty much describe themselves.</p><p>Here is the whole code for the add-on:</p><pre><code>:::javascript
var contextMenu = require(&quot;sdk/context-menu&quot;);
var tabs = require(&quot;sdk/tabs&quot;);

var script = 'self.on(&quot;context&quot;, function(){'+
             &quot;    return 'Search MDN for \&quot;'+window.getSelection().toString()+'\&quot;';&quot;+
             '});'+
             'self.on(&quot;click&quot;, function(){'+
             '   self.postMessage(window.getSelection().toString());'+
             '});';


var menuItem = contextMenu.Item({
    label: &quot;Search on MDN&quot;,
    context: contextMenu.SelectionContext(),
    contentScript: script,
    onMessage: function(selectionText){
        var url = &quot;https://google.com/search?btnI&amp;q=site:developer.mozilla.org &quot;+selectionText;
        url = url.replace(&quot; &quot;, &quot;+&quot;);
        tabs.open(url);
    }
});
</code></pre><p>As you can see there, there isn&rsquo;t much to do. The first two lines are the import statement to access some of the browser feature. Skip the <code>script</code> variable for now. Next, the we create a new context menu, give it a label, and we declare the context so that the item only shows up when there is a something selected.</p><p>Next, we pass the <code>contentScript</code> argument, which defines the behavior of the menu item even further. Many things can be done through the <code>contentScript</code>, such as to scope down the context even further, set the click behaviour, etc. The argument takes a string, and we passed the <code>script</code> variable as the argument. In this case, the <code>context</code> event is are fired just before the context menu is displayed, and we change the label further to add the selected text. We also handles the <code>click</code> event, and with it, we call the <code>postMessage</code> to pass the the selected text, which we handle with the function passed to the <code>onMessage</code> argument, and in it, we open a new tab with the search URL.</p><p>As you might imagine, passing the script that defines the behavior of the add-on as a string literal isn&rsquo;t really nice when script is something a little more complicated. You can pass external javascript files to the <code>contentScriptFile</code> argument to accomplish the same thing. Although there are several differences in the way the script is executed, but I won&rsquo;t go into it too much in this post. More on it <a href=https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/guides/content-scripts/loading.html>here</a>.</p><p>There is a lot more you can do with the add-on. You can scan through more features available on the documentation. There are more examples on the add-ons SDK&rsquo;s <a href=https://github.com/mozilla/addon-sdk>Github</a> repository. By the way, the add-on mentioned above is available on <a href=https://github.com/hdra/ff-MDNSearch>Github</a> as well. Also, the add-on we built here is just a simple plugin to show the basics of the Firefox plugin API, not really meant for actual use. It doesn&rsquo;t handle plenty of use cases, and it also relies on Google&rsquo;s Feeling Lucky version to directly open the first search first result. so I don&rsquo;t really recommend you actually using it for anything serious.</p></article></div></body></html>